{% extends "base.html" %}

{% block title %}WizData - Live Data Collection{% endblock %}
{% block page_title %}Sources{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="mb-8">
    <h1 class="text-3xl font-bold text-white mb-2">Live Data Collection Center</h1>
    <p class="text-gray-400">Real-time financial data scraping and monitoring</p>
</div>

<!-- System Overview Cards -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm font-medium">Active Scrapers</p>
                <p class="text-2xl font-bold text-white mt-1" id="total-scrapers">8</p>
            </div>
            <div class="p-3 bg-blue-600 rounded-lg">
                <i data-lucide="cpu" class="w-6 h-6 text-white"></i>
            </div>
        </div>
    </div>

    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm font-medium">Data Points/Hour</p>
                <p class="text-2xl font-bold text-white mt-1" id="data-points">12.4K</p>
            </div>
            <div class="p-3 bg-green-600 rounded-lg">
                <i data-lucide="activity" class="w-6 h-6 text-white"></i>
            </div>
        </div>
    </div>

    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm font-medium">Success Rate</p>
                <p class="text-2xl font-bold text-white mt-1" id="success-rate">98.2%</p>
            </div>
            <div class="p-3 bg-purple-600 rounded-lg">
                <i data-lucide="target" class="w-6 h-6 text-white"></i>
            </div>
        </div>
    </div>

    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm font-medium">Queue Size</p>
                <p class="text-2xl font-bold text-white mt-1" id="queue-size">24</p>
            </div>
            <div class="p-3 bg-yellow-600 rounded-lg">
                <i data-lucide="layers" class="w-6 h-6 text-white"></i>
            </div>
        </div>
    </div>
</div>

<!-- Scrapers Grid -->
<div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
    <!-- JSE Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">JSE Market Data</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">2 mins ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Symbols:</span>
                <span class="text-gray-300">8 tracked</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">100%</span>
            </div>
        </div>
    </div>

    <!-- Crypto Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">Cryptocurrency</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">30 secs ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Symbols:</span>
                <span class="text-gray-300">10 tracked</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">99.8%</span>
            </div>
        </div>
    </div>

    <!-- Forex Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">Forex Rates</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">1 min ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Pairs:</span>
                <span class="text-gray-300">7 tracked</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">97.5%</span>
            </div>
        </div>
    </div>

    <!-- News Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">Financial News</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">5 mins ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Articles:</span>
                <span class="text-gray-300">156 today</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">95.2%</span>
            </div>
        </div>
    </div>

    <!-- Economic Data Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">Economic Indicators</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">15 mins ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Indicators:</span>
                <span class="text-gray-300">25 tracked</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">98.8%</span>
            </div>
        </div>
    </div>

    <!-- Market Events Scraper -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-white">Market Events</h3>
            <span class="px-2 py-1 bg-green-600 text-green-100 rounded-full text-xs font-medium">
                <i data-lucide="circle" class="w-3 h-3 inline mr-1 fill-current"></i>
                Active
            </span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Last Update:</span>
                <span class="text-gray-300">8 mins ago</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Events:</span>
                <span class="text-gray-300">12 today</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="text-gray-400">Success Rate:</span>
                <span class="text-green-400">100%</span>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity Log -->
<div class="bg-gray-800 rounded-lg border border-gray-700">
    <div class="p-6 border-b border-gray-700">
        <h3 class="text-lg font-semibold text-white">Recent Activity</h3>
        <p class="text-gray-400 text-sm mt-1">Live data collection events</p>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead>
                <tr class="border-b border-gray-700">
                    <th class="text-left p-4 text-gray-400 font-medium">Time</th>
                    <th class="text-left p-4 text-gray-400 font-medium">Source</th>
                    <th class="text-left p-4 text-gray-400 font-medium">Event</th>
                    <th class="text-left p-4 text-gray-400 font-medium">Status</th>
                    <th class="text-right p-4 text-gray-400 font-medium">Records</th>
                </tr>
            </thead>
            <tbody id="activity-log">
                <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors">
                    <td class="p-4 text-gray-300">13:32:45</td>
                    <td class="p-4 text-white">CoinGecko API</td>
                    <td class="p-4 text-gray-300">Price update batch</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-green-600 text-green-100 rounded text-xs">Success</span>
                    </td>
                    <td class="p-4 text-right text-gray-300">10</td>
                </tr>
                <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors">
                    <td class="p-4 text-gray-300">13:31:12</td>
                    <td class="p-4 text-white">JSE Direct</td>
                    <td class="p-4 text-gray-300">Stock price sync</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-green-600 text-green-100 rounded text-xs">Success</span>
                    </td>
                    <td class="p-4 text-right text-gray-300">8</td>
                </tr>
                <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors">
                    <td class="p-4 text-gray-300">13:29:58</td>
                    <td class="p-4 text-white">Currency API</td>
                    <td class="p-4 text-gray-300">Exchange rates</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-green-600 text-green-100 rounded text-xs">Success</span>
                    </td>
                    <td class="p-4 text-right text-gray-300">7</td>
                </tr>
                <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors">
                    <td class="p-4 text-gray-300">13:28:34</td>
                    <td class="p-4 text-white">News RSS</td>
                    <td class="p-4 text-gray-300">Financial news feed</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-green-600 text-green-100 rounded text-xs">Success</span>
                    </td>
                    <td class="p-4 text-right text-gray-300">15</td>
                </tr>
                <tr class="hover:bg-gray-700 transition-colors">
                    <td class="p-4 text-gray-300">13:27:21</td>
                    <td class="p-4 text-white">Economic Calendar</td>
                    <td class="p-4 text-gray-300">Events update</td>
                    <td class="p-4">
                        <span class="px-2 py-1 bg-green-600 text-green-100 rounded text-xs">Success</span>
                    </td>
                    <td class="p-4 text-right text-gray-300">3</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Auto-refresh activity log every 10 seconds
setInterval(function() {
    // Simulate new activity (in production, this would fetch from API)
    const now = new Date();
    const timeStr = now.toTimeString().slice(0, 8);
    
    // Update metrics with slight variations
    const currentPoints = document.getElementById('data-points');
    if (currentPoints) {
        const current = parseFloat(currentPoints.textContent);
        const variation = (Math.random() - 0.5) * 0.2;
        currentPoints.textContent = (current + variation).toFixed(1) + 'K';
    }
}, 10000);

// Initialize real-time updates
document.addEventListener('DOMContentLoaded', function() {
    console.log('Live Data Collection Center initialized');
});
</script>
{% endblock %}